import{g as m,s as p,b as g}from"./utils-DJxqsy3g.js";import{E as h}from"./ExternalServices-BOC11meF.js";class y{constructor(n,e){this.productId=n,this.product={},this.dataSource=e}async init(){this.product=await this.dataSource.findProductById(this.productId),console.log("Loaded product:",this.product),this.renderProductDetails(),document.getElementById("addToCart").addEventListener("click",this.addProductToCart.bind(this))}addProductToCart(){const n=m("so-cart")||[],e=n.findIndex(o=>o.Id===this.product.Id);if(e>-1)n[e].quantity+=1;else{const o={...this.product,quantity:1};n.push(o)}p("so-cart",n)}renderProductDetails(){I(this.product)}}function I(t){var i,s,l;document.querySelector("h2").textContent=((i=t.Brand)==null?void 0:i.Name)||"Unknown Brand",document.querySelector("h3").textContent=t.NameWithoutBrand||t.Name;const n=document.getElementById("productImage");n.src=t.Image||"/images/default.jpg",n.alt=t.NameWithoutBrand||"Product Image";const e=document.getElementById("productPrice");e.innerHTML="";const o=parseFloat(t.SuggestedRetailPrice),d=parseFloat(t.FinalPrice);if(!isNaN(o)&&!isNaN(d)&&d<o){const u=Math.round((o-d)/o*100),c=document.createElement("span");c.textContent=`$${o.toFixed(2)}`,c.style.textDecoration="line-through",c.style.marginRight="8px";const r=document.createElement("span");r.textContent=`$${d.toFixed(2)}`,r.style.color="green",r.style.fontWeight="bold";const a=document.createElement("p");a.textContent=`Discounted! Save ${u}%`,a.style.color="red",a.style.fontStyle="italic",a.style.marginTop="4px",e.appendChild(c),e.appendChild(r),e.appendChild(a)}else e.textContent=`$${d.toFixed(2)}`;document.getElementById("productColor").textContent=((l=(s=t.Colors)==null?void 0:s[0])==null?void 0:l.ColorName)||"N/A",document.getElementById("productDesc").innerHTML=t.DescriptionHtmlSimple||"No description available.",document.getElementById("addToCart").dataset.id=t.Id}const P=h,C=g("product"),x=["tents","backpacks","sleeping-bags"];async function f(t){for(let n of x){const e=new P(n),o=await e.findProductById(t);if(o){const d=new y(t,e);d.product=o,d.renderProductDetails(),document.getElementById("addToCart").addEventListener("click",d.addProductToCart.bind(d));return}}document.querySelector("main").innerHTML=`
    <h2>Product Not Found</h2>
    <p>No product matches ID <strong>${t}</strong>.</p>
  `}f(C);
